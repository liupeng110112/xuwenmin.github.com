---
layout: post
category : NodeJS
tagline: ""
tags : [nodejs,开发指南]
---
{% include JB/setup %}

![NodeJS开发指南](http://images.smarter.com.cn/product_image_b/1011/15/6672215.jpg)

这本书是市面上讲nodejs的一本不可多得的入门书，当初想学  nodejs的时候，找了半天，终于找到了这本好书，随后一发不可收拾，花了一两天的功夫就看玩了，感觉作者系统功力深厚，以下只是偶的一些摘要，权当心得体会。

---

书里说nodejs的核心特性是异步IO，事件驱动，任何IO操作都是由事件来驱动的。

说到异步IO又不得不来看看操作系统的`线程与阻塞`。

什么是阻塞呢，`线程在执行中遇到磁盘读写或者数据库通讯，网络通讯这种耗时比较多的时候，操作系统将会剥夺此线程的CPU资源，并暂停此线程，转而去执行别的线程，此线程调度方式称为阻塞`。当I/O操作完成之后，操作系统又恢复此线程，让其继续执行，这种I/O模式通常称为同步I/O或者阻塞式I/O。

异步式IO或者非阻塞式I/O则针对所有操作采取不阻塞的方式，当线程遇到IO操作的时候，不会以阻塞的方式等待IO操作完成或者数据的返回，而是将IO操作发送给操作系统，然后接着执行下一个操作，当操作系统执行完IO操作之后，将是事件的方式通知执行IO的线程，线程会在特定的时候执行这个事件。这一切的前提条件就是，系统需要一个事件循环,以不断的去查询有没有未处理的事件，然后给预处理。

阻塞方式下，一个线程只能处理一个任务，要想提高系统的吞吐量，必须使用多线程 ;而非阻塞情况下，一个线程永远在执行计算，CPU使用率几乎100%,IO以事件的方式通知。在阻塞模式下，多线程能够提高系统吞吐量，因为一个线程在阻塞的时候，还有另一个线程在工作，多线程 不会让CPU资源在线程阻塞的时候浪费。而在非阻塞模式下，线程不会被IO阻塞，CPU资源也不会浪费。多线程只是在多核的时候利用更多的核，而nodejs的单线程也能带来这个好处。所以这就是nodejs采取单线程，非阻塞的事件编程模式。 

以下是书中的两幅图，

![img1](http://images.cnitblog.com/blog/22616/201303/28205345-204e2ec8e7514c5781bf4d4eba43a702.png)

![img2](http://images.cnitblog.com/blog/22616/201303/28205407-f8a8fe576b91455d8bfd3b649f3f8923.png)

再弄一个同步式IO与异步式IO的特点比较，依然用书中的图

![img3](http://images.cnitblog.com/blog/22616/201303/28205456-f20490b2a4b048558d65cf460d1cfb26.png)

最后以异步读取一个本地的文件来结束本文，：）

```js
//demo.js 
//加载文件模块 
  var fs=require('fs');  
 fs.readFile('a.txt','utf-8',function(err,data){  
   if (err){  
      console.log(err)   
  }else{   
     console.log(data);   
  }
 });
 console.log('there is firstprint'); 
```

以上代码，可以在命令行中，切换到demo.js的目录中，输入node demo.js回车即可运行看到结果。